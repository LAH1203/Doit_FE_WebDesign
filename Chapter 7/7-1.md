# 7-1. 뷰포트와 미디어 쿼리 알아보기
미디어 쿼리는 접속하는 웹 브라우저 창의 너비에 따라 사이트의 레이아웃을 바꾸기 때문에 반응형 웹 사이트를 제작하는 가장 기본적인 방법이다. 하나의 사이트를 데스크톱과 스마트폰 모두에서 볼 수 있게 하려면 웹 문서 안의 글자나 이미지, 비디오 같은 내용이 유연하게 늘어나거나 줄어들 수 있어야 하는데, 그렇게 동작하기 위해 필요한 것이 **뷰포트**이다.

<br>

## 뷰포트 설정하기
요즘처럼 스마트폰까지 고려한 반응형 웹을 제작할 때는 미디어 쿼리를 주로 사용한다. 미디어 쿼리의 기본 동작 원리는 조건에 맞게 콘텐츠의 배치를 다르게 하는 것이다. 이 때 가장 많이 사용하는 조건이 화면의 크기나 기기의 방향인데, 이 조건을 체크할 때 사용하는 것이 바로 **뷰포트(Viewport)** 이다.

뷰포트는 스마트폰에서 실제 콘텐츠가 표시되는 부분을 가리키는 말이다. 뷰포트를 설정하지 않고 데스크톱용과 스마트폰용 문서를 한 가지로 작성할 경우, 스마트폰에서는 글자가 아주 작게 표시되어 사용자가 화면을 확대하지 않으면 제대로 내용을 알아보기 어려워진다.

이는 데스크톱의 1px과 스마트폰의 1px은 실제 크기가 다름에도 데스크톱 화면에서 사용하는 너빗값을 스마트폰에도 그대로 적용해서 생기는 현상이다. 예를 들어, 문서 너비를 960px로 지정했다면 작은 스마트폰 화면을 웹 문서 너비인 960px 크기로 간주하고 문서 안의 내용을 그대로 표시한다. 그렇기 때문에 문서 안의 글자나 이미지가 아주 작게 표시되는 것이다.

따라서 웹 문서의 글자나 이미지 같은 콘텐츠를 스마트폰 화면에서 잘 보이는 크기로 표시하려면 스마트폰 화면을 웹 문서 너비에 맞추는 것이 아니라 그 반대로 문서의 콘텐츠를 스마트폰 화면 너비에 맞춰 표시해야 한다. 이 때 사용하는 것이 `<meta>` 태그이며, 다음 소스가 가장 기본으로 사용하는 뷰포트 설정 소스이다.

```html
<meta name="viewport" content="width=device-width, initial-scale=1">
```

1. width=device-width : 문서 너비를 현재 기기의 너비에 맞춘다.
2. initial-scale=1 : 문서를 불러와 화면에 표시할 때 기본 배율을 1로 지정한다.

`<meta>` 태그에서 뷰포트를 설정하기 위해 사용하는 속성을 정리하면 다음과 같다.

| 속성 | 설명 |
|---|---|
| width | 뷰포트의 너비<br>기본값 : device-width |
| height | 뷰포트의 높이<br>기본값 : device-height |
| initial-scale | 초기 배율<br>기본값 : 1 (1보다 작은 값이면 축소 페이지, 큰 값이면 확대 페이지 표시) |
| user-scalable | 사용자가 페이지를 확대/축소할 수 있는지 여부 지정<br>기본값 : yes |
| minimum-scale | 확대/축소할 수 있는 최솟값(가로 기준)<br>기본값 : 0.25 |
| maximum-scale | 확대/축소할 수 있는 최댓값(가로 기준)<br>기본값 : 5.0 |
| target-densityDpi | 고해상도 단말기의 화면 해상도에 맞출 수 있도록 페이지 확대<br>기본값 : device-dpi |

<br>

## 미디어 쿼리 구문
미디어 쿼리를 사용하기 위해서는 CSS를 정의하는 `<style>` 태그 안에 다음과 같은 구문을 삽입한다. 이 때 대소문자는 구별하지 않는다.

#### 기본 형식
```html
@media [only | not] 미디어 유형 [and 조건] * [and 조건]
```
- 구문에서 \[]는 선택 항목이라는 의미이고, |는 또는(or), \*는 반복을 뜻한다.
- `@media` : 스타일 시트 안에서 미디어 쿼리를 시작하는 속성이다.
- `only | not` : 미디어 쿼리를 적용할 유형을 지정할 때 사용하는 접두어(Prefix)이다. only 접두어를 사용하면 only 다음의 미디어 유형에만 적용되고, not을 이용하면 not 다음의 미디어 유형을 제외한 나머지 유형에만 적용된다.
- 미디어 유형 : 화면인지 프린터인지, TV인지 등 미디어 쿼리를 적용할 기기를 지정하는 부분이다. 쉼표(,)를 사용해 여러 가지 미디어 유형을 나열할 수 있다.
- 조건 : 미디어 유형 외에 기기와 관련된 조건을 지정한 후 해당 조건에 맞는 경우에만 CSS가 적용되도록 지정할 수 있다. 조건은 괄호()로 묶어서 표현하며 둘 이상의 조건을 나열할 경우 and 연산자를 사용한다.

<br>

### 미디어 유형
미디어 쿼리는 화면뿐만 아니라 프린터, TV 등 여러 기기에 적용할 수 있는데, 미디어 쿼리 구문 중 '미디어 유형' 항목에 원하는 미디어 유형을 지정하면 된다. 자주 사용하는 미디어 유형은 다음과 같으며, 미디어 유형을 적용하지 않으면 사이트에 접속하는 모든 기기에 미디어 쿼리가 적용된다.

| 미디어 유형 | 설명 |
|---|---|
| all | 모든 미디어<br>기본값 |
| screen | 화면이 달려있는 기기<br>스마트폰과 PC 모두 해당 |
| print | 인쇄 장치 |
| tv | 음성과 영상이 동시 출력되는 TV |
| aural | 음성 합성 장치 |
| braille | 점자 표시 장치 |
| handheld | 손에 들고 다니는 장치 |
| projection | 프로젝터 |
| tty | 화면이 없는 장치 |
| embossed | 페이지에 인쇄된 점자 표지 장치 |

<br>

### 조건
앞에서 사이트를 열어보고 화면 너비가 달라지면 사이트의 레이아웃이 바뀌는 것을 보았다. 사용자에 따라 달라지는 화면 너비가 미디어 쿼리를 실행할 조건이고, 미디어 쿼리 구문 중 '조건' 항목에 그 크기를 지정하면 된다.

다음은 미디어 쿼리에서 사용하는 조건 속성 중 일부이다. 이 속성 중에서 orientation을 제외하면 각 속성의 앞에 min-이나 max- 접두어를 붙여 최솟값이나 최댓값을 표현할 수 있다.

| 디스플레이 | 설명 |
|---|---|
| width | 웹 문서의 너비 |
| height | 웹 문서의 높이 |
| device-width | 기기의 너비 |
| device-height | 기기의 높이 |
| orientation | 화면의 방향<br>landscape(가로), portrait(세로) 중 선택 |
| aspect-ratio | 화면 비율 |
| device-aspect-ratio | 기기의 화면 비율 |
| resolution | 기기의 해상도 |

| 색상 | 설명 |
|---|---|
| color | 기기의 비트 수 |
| color-index | 기기의 색상 수 |

- 더 많은 조건 속성은 www.w3.org/TR/mediaqueries-4 에서 확인가능하다.

예를 들어, 화면 너빗값이 1260px 이하일 경우 적용한 스타일을 정의한다면 미디어 쿼리를 사용해 다음과 같이 지정할 수 있다. 이 때 {와 } 사이에 스타일 속성을 표시한다. 미디어 쿼리를 적용한 미디어 유형은 'screen'이고 조건은 (max-width: 1260px)이다.

```html
@media screen and (max-width: 1260px) {}
```

만일 다른 조건을 더 넣고싶다면 and 예약어(키워드)와 함께 괄호() 안에 조건을 제시하면 된다. 이 때 조건의 순서는 상관 없다. 예를 들어 921px 이상이면서 1260px 이하일 경우의 스타일을 따로 지정하고 싶다면 다음과 같은 미디어 쿼리 구문을 사용한다.

```html
@media screen and (min-width: 921px) and (max-width: 1260px) {}
```

<br>

## 미디어 쿼리 중단점
미디어 쿼리를 작성할 때 화면 크기에 따라 서로 다른 CSS를 적용할 분기점을 **중단점(Break Point)** 이라고 한다. 예를 들어 다음 미디어 쿼리는 1260px 이하일 경우에 적용되므로 1260px이 중단점이 된다.

```html
@media screen and (max-width: 1260px) {}
```

미디어 쿼리 중단점을 어떻게 지정하느냐에 따라 CSS가 달라지고 화면 레이아웃이 바뀌는데, 대부분 **기기의 화면 크기**를 기준으로 한다.

하지만 시중의 모든 기기를 반영할 수는 없기 때문에 주로 **작은 화면과 중간 화면, 큰 화면** 정도로 구분 짓고 필요할 경우 좀 더 세분화하기도 한다. 그리고 처리 속도나 화면 크기 등에서 다른 기기보다 모바일기기의 제약 조건이 더 많기 때문에 **모바일 기기의 레이아웃**을 기본으로 하여 CSS를 만든다. 그러고 나서 좀 더 사양이 좋고 화면이 큰 태블릿과 데스크톱에 맞춰 더 많은 기능과 스타일을 추가하는데 이렇게 모바일을 먼저 고려하여 미디어 쿼리를 작성하는 것을 '모바일 퍼스트(Mobile First)'라고 한다.

모바일 퍼스트 디자인을 하면 모바일에 사용한 스타일이 그대로 태블릿과 데스크톱에도 적용된다. 그래서 태블릿용 미디어 쿼리나 PC용 미디어 쿼리에서는 모바일 CSS에서 바꿀 부분만 지정하면 된다.

예전에는 '모바일', '태블릿', '데스크톱'처럼 기기 중심으로 미디어 쿼리 중단점을 나누었지만 다양한 업체에서 새로운 기기가 계속 등장하고 바뀌는 속도도 빠르기 때문에 기기를 기준으로 하는 것은 바람직하지 않다.

**중단점을 정할 때는 콘텐츠를 기준으로 하는 것이 좋다.** 우선 작은 화면을 기준으로 콘텐츠를 제작하고 화면을 점점 늘려가다가 콘텐츠 배치를 다르게 해야 할 크기가 되면 중단점을 추가한다.

- 모바일 기기별로 더욱 자세한 중단점을 알고 싶다면 css-tricks.com/snippets/css/media-queries-for-standard-devices 를 참고하자.

<br>

#### 미디어 쿼리를 지원하지 않는 브라우저에 대응하려면
인터넷 익스플로러 6~8 버전을 비롯해 미디어 쿼리를 지원하지 않는 브라우저에서도 반응형 웹이 동작하도록 설계하려면 respond.js 자바스크립트 라이브러리를 다운로드해서 링크하면 된다.

- respond.js를 다운로드하려면 github.com/scottjehl/Respond 로 들어가 화면 오른쪽 위에 있는 'Clone or download - Download ZIP'를 클릭해 전체 파일을 다운로드한 뒤, 파일의 압축을 푼 후 src\\respond.js 파일을 원하는 폴더로 복사한다.
- 그리고 CSS의 조건 주석문을 사용해 인터넷 익스플로러 9 이하 버전일 경우 respond.js 파일을 가져오는 소스를 작성한다. respond.js 파일 경로를 표시할 때는 폴더 이름까지 함께 표기해야 하는데, 만일 script 폴더 안에 저장했다면 다음과 같이 작성한다.

```html
<!-- [if It IE 9]
  <script src = "script/respond.js"></script>
<[endif]-->
```
